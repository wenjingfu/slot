init(50,"mylegend",720,1280,main);var loadingLayer;var backLayer;var startLayer;var lightLayer;var loadIndex = 0;var imglist = {};var btnup,btndown,btnleft,btnright;var imgData = new Array();var mapImgList = new Array();var mapmoveflag = "";var MOVE_STEP = 10;// var combination = new Array([1,1,5], [1,2,4], [1,5,1], [2,1,4], [2,3,3], [2,4,1], [2,5,4], [3,1,2], [3,4,3], [3,5,5], [4,1,2], [4,2,3], [4,5,1], [4,5,5], [5,1,1], [5,2,4], [5,3,2], [5,5,1], [1,1,1], [1,1,1]);var combination = new Array([1,1,1],[1,1,5], [1,2,4], [1,5,1], [2,1,4], [2,3,3], [2,4,1], [2,5,4],[2,2,2],[3,3,3],[3,1,2], [3,4,3], [3,5,5], [4,4,4],[4,1,2], [4,2,3], [4,5,1], [4,5,5], [5,5,5],[5,1,1],[5,2,4], [5,3,2], [5,5,1],[6,6,6]);var reels = new Array();var kakes = new Array();var lightArr = new Array();var start;var win;function main(){	imgData.push({name:"start_up",path:"./images/start_up.png"});	imgData.push({name:"start_over",path:"./images/start_over.png"});	imgData.push({name:"kake",path:"./images/kake.png"});	imgData.push({name:"slot_back",path:"./images/back.png"});	imgData.push({name:"light",path:"./images/light.png"});	imgData.push({name:"light_off",path:"./images/light_off.png"});	imgData.push({name:"item1",path:"./images/1.png"});	imgData.push({name:"item2",path:"./images/2.png"});	imgData.push({name:"item3",path:"./images/3.png"});	imgData.push({name:"item4",path:"./images/4.png"});	imgData.push({name:"item5",path:"./images/5.png"});	imgData.push({name:"item6",path:"./images/6.png"});	loadingLayer = new LoadingSample1();	addChild(loadingLayer);		LLoadManage.load(		imgData,		function(progress){			loadingLayer.setProgress(progress);		},		function(result){			imglist = result;			removeChild(loadingLayer);			loadingLayer = null;			gameInit();		}	);}function gameInit(event){	var i,j,bitmap,bitmapdata,childmap;	backLayer = new LSprite();	addChild(backLayer);	bitmapdata = new LBitmapData(imglist["slot_back"]);	bitmap = new LBitmap(bitmapdata);	backLayer.addChild(bitmap);	theTextField = new LTextField();	theTextField.text = "+";	theTextField.x = 330;	theTextField.y = 555;	theTextField.color = "#07880d";	theTextField.weight = "bolder";	theTextField.size = 30;	backLayer.addChild(theTextField);	theTextField1 = new LTextField();	theTextField1.text = "100";	theTextField1.x = 350;	theTextField1.y = 555;	theTextField1.color = "#07880d";	theTextField1.weight = "bolder";	theTextField1.size = 30;	backLayer.addChild(theTextField1);	webview = new LStageWebView();	webview.setViewPort(new LRectangle(98,800,523,425));	webview.loadURL("http://www.lufylegend.com");	webview.show();	lightLayer = new LSprite();	addChild(lightLayer);	for(i=0;i<3;i++){		var reel = new Reel(combination,i);		reel.x = 155 * i + 160;		reel.y = 270;		reels.push(reel);		addChild(reel);		var kake = new LBitmap(new LBitmapData(imglist["kake"]));		kake.x = 154 * i + 158;		kake.y = 264;		kakes.push(kake);		addChild(kake);		var light_off = new LBitmap(new LBitmapData(imglist["light_off"]));		var light = new LBitmap(new LBitmapData(imglist["light"]));		light_off.x = 120 *i + 55;		light_off.y = 645;		light_off.visible = true;		light.x =120 *i + 55;		light.y = 645;		light.visible = false;		lightArr.push([light_off,light]);		lightLayer.addChild(light_off);		lightLayer.addChild(light);	}	startLayer = new LSprite();	addChild(startLayer);	start = new LButton(new LBitmap(new LBitmapData(imglist["start_up"])),0,new LBitmap(new LBitmapData(imglist["start_over"])));	start.x = 463;	start.y = 600;	startLayer.addChild(start);	start.addEventListener(LMouseEvent.MOUSE_UP, onmouseup);	backLayer.addEventListener(LEvent.ENTER_FRAME,onframe);}function onframe(){	var i;	for(i=0;i<3;i++){		reels[i].onframe();	}}function stopevent(event,currentTarget){	reels[currentTarget.index].stopFlag = true;}function onmouseup(event){	if (theTextField1.text == 0) {		console.log("金币为0，请点击广告获取金币");		start.setState(LButton.STATE_DISABLE);		return;	} else {		start.setState(LButton.STATE_ENABLE);	}	theTextField1.text -= 10;	var i;	var stopNum = Math.floor(Math.random()*(combination.length));	start.visible = true;	for(i=0;i<3;i++){		setTimeout( (function(i) {        	return function() {        	reels[i].startReel = true;			reels[i].stopFlag = false;			reels[i].stopNum = stopNum;			setTimeout(function () {				reels[i].stopFlag = true;			},2000)        }    	})(i), i*300 );	}}function checkWin(){	var allstop = 0;	for(var i=0;i<3;i++){		if(!reels[i].startReel)allstop++;	}	if(allstop >= 3){		var count = 0;		for (var i=0; i<2; i++) {			for (var m=i+1; m<3;m++){				if (reels[i].currentNum == reels[m].currentNum) {					count += 1;				}			}		}		isLightOn(count);		if (count == 3) {			theTextField1.text += 10;		}	}}function isLightOn (count) {	console.log("相等数:" + count);	if (count == 3){		lightArr[0][0].visible = false;		lightArr[1][0].visible = false;		lightArr[2][0].visible = false;		lightArr[0][1].visible = true;		lightArr[1][1].visible = true;		lightArr[2][1].visible = true;	} else if (count == 1) {		lightArr[0][0].visible = false;		lightArr[1][0].visible = false;		lightArr[2][0].visible = true;		lightArr[0][1].visible = true;		lightArr[1][1].visible = true;		lightArr[2][1].visible = false;	} else {		lightArr[0][0].visible = true;		lightArr[1][0].visible = true;		lightArr[2][0].visible = true;		lightArr[0][1].visible = false;		lightArr[1][1].visible = false;		lightArr[2][1].visible = false;	}}